node {
  // Set Maven home explicitly if needed
  def mavenHome = '/opt/maven'  // Adjust if Maven is installed elsewhere

  withEnv(["MAVEN_HOME=${mavenHome}", "PATH=${mavenHome}/bin:${env.PATH}"]) {

    stage('1-Clone') {
      git credentialsId: 'GitHUB-CREDENTIALS', url: 'https://github.com/DevopStan/maven-web-application'
    }

    stage('2-mavenBuild') {
      sh "${mavenHome}/bin/mvn clean package"
    }

    stage('3-CodeQuality') {
      sh "${mavenHome}/bin/mvn sonar:sonar"
    }
  }
}
